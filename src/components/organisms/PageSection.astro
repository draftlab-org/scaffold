---
import Image from '@components/atoms/Image.astro';
import type { ImageMetadata } from 'astro';

export interface Props {
  title?: string;
  subtitle?: string;
  image?: ImageMetadata | string;
  imageAlt?: string;
  imagePosition?: 'left' | 'right' | 'top' | 'bottom' | 'background';
  contentWidth?: 'narrow' | 'wide' | 'full';
  padding?: 'sm' | 'md' | 'lg' | 'xl';
  class?: string;
}

const {
  title,
  subtitle,
  image,
  imageAlt = '',
  imagePosition = 'right',
  contentWidth = 'wide',
  padding = 'lg',
  class: className = '',
} = Astro.props;

const paddingClasses = {
  sm: 'py-8 md:py-12',
  md: 'py-12 md:py-16',
  lg: 'py-16 md:py-24',
  xl: 'py-24 md:py-32',
};

const contentWidthClasses = {
  narrow: 'max-w-3xl',
  wide: 'max-w-6xl',
  full: 'max-w-full',
};

const gridClasses = {
  left: 'md:grid-cols-2 md:gap-12',
  right: 'md:grid-cols-2 md:gap-12',
  top: 'grid-cols-1',
  bottom: 'grid-cols-1',
  background: 'grid-cols-1',
};

const imageOrderClass = imagePosition === 'left' ? 'md:order-first' : '';
const contentOrderClass = imagePosition === 'left' ? 'md:order-last' : '';
---

<section class={`relative w-full ${paddingClasses[padding]} ${className}`}>
  {/* Background Image Mode */}
  {imagePosition === 'background' && image && (
    <div class="absolute inset-0 z-0">
      <Image
        src={image}
        alt={imageAlt}
        class="h-full w-full object-cover opacity-10"
      />
    </div>
  )}

  <div class={`relative z-10 mx-auto px-6 ${contentWidthClasses[contentWidth]}`}>
    <div class={`grid ${gridClasses[imagePosition]} items-center gap-8`}>
      {/* Content */}
      <div class={`space-y-6 ${contentOrderClass}`}>
        {title && (
          <h2 class="text-3xl font-bold md:text-4xl lg:text-5xl">{title}</h2>
        )}
        {subtitle && (
          <p class="text-lg text-neutral-600 md:text-xl">{subtitle}</p>
        )}

        <div class="prose prose-lg max-w-none">
          <slot />
        </div>

        <div class="pt-4">
          <slot name="actions" />
        </div>
      </div>

      {/* Image (for left/right/top/bottom positions) */}
      {image && imagePosition !== 'background' && (
        <div class={imageOrderClass}>
          <Image
            src={image}
            alt={imageAlt}
            class="h-auto w-full rounded-lg shadow-lg"
          />
        </div>
      )}
    </div>
  </div>
</section>
