---
import { getCollection } from 'astro:content';
import peopleBG from '@assets/backgrounds/anna-magenta-vKhd5bnnolg-unsplash.jpg';
import PeopleFilteredGrid from '@components/organisms/PeopleFilteredGrid';
import HeroSection from '@components/sections/HeroSection.astro';
import PageLayout from '@layouts/PageLayout.astro';
import SectionLayout from '@layouts/SectionLayout.astro';
import { getAllSections } from '@utils/people';

// Get all people from the collection
const peopleEntries = await getCollection('people');

// Get all sections for filtering
const sections = await getAllSections();

// Serialize people for the React component
const serializedPeople = peopleEntries.map((entry) => ({
  id: entry.data.id,
  name: entry.data.name,
  title: entry.data.title,
  headshot: entry.data.headshot.src,
  sections: entry.data.sections,
}));
---

<PageLayout
	title="People - Draftlab Scaffold"
	description="Meet our team members"
	image={peopleBG}
>
	<!-- Hero Section -->
	<SectionLayout bgImage={peopleBG} sectionLabel="hero">
		<HeroSection
			title="Our Team"
			subtitle="Meet the amazing people who make everything possible"
		/>
	</SectionLayout>

	<!-- People Grid with Filtering -->
	<SectionLayout>
		<section class="py-16">
			<PeopleFilteredGrid
				client:load
				people={serializedPeople}
				sections={sections}
				groupBySection={true}
			/>
		</section>
	</SectionLayout>
</PageLayout>
